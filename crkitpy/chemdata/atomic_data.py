# -*- coding: utf-8 -*-
# @Time     : 2020/6/10 11:07
# @Author   : zbc
# @Email    : zhangbc0315@outlook.com
# @FileName : atomic_data.py
# @Software : PyCharm

from typing import List, Tuple
from collections import namedtuple

import re


AtomicD = namedtuple('AtomicD', ['atomic_num',
                                 'symbol',
                                 'covalent_radius',
                                 'rb0',
                                 'van_radius',
                                 'atomic_mass',
                                 'outshell_elec_num',
                                 'common_isotopic',
                                 'common_isotopic_mass',
                                 'valences'])


class AtomicData:

    _periodic_table_atom_data_str = "1	H 	0.23	0.33	1.2	1.008	1	1	1.007825032	1 \n \
                                     2	He	0.93	0.7	1.4	4.003	2	4	4.002603254	0  \n \
                                     3	Li	0.68	1.23	2.2	6.941	1	7	7.01600455	1  \n \
                                     4	Be	0.35	0.9	1.9	9.012	2	9	9.0121822	2  \n \
                                     5	B	0.830	0.82	1.8	10.812	3	11	11.0093054	3  \n \
                                     6	C	0.68	0.77	1.7	12.011	4	12	12	4 \n \
                                     7	N	0.68	0.7	1.6	14.007	5	14	14.003074	3 \n \
                                     8	O	0.68	0.66	1.55	15.999	6	16	15.99491462	2 \n \
                                     9	F	0.64	0.611	1.5	18.998	7	19	18.99840322	1 \n \
                                     10	Ne	1.12	0.7	1.54	20.18	8	20	19.99244018	0 \n \
                                     11	Na	0.97	1.54	2.4	22.99	1	23	22.98976928	1 \n \
                                     12	Mg	1.1	1.36	2.2	24.305	2	24	23.9850417	2 \n \
                                     13	Al	1.35	1.18	2.1	26.982	3	27	26.98153863	3	6 \n \
                                     14	Si	1.2	0.937	2.1	28.086	4	28	27.97692653	4	6 \n \
                                     15	P	0.75	0.89	1.95	30.974	5	31	30.97376163	3	5	7 \n \
                                     16	S	1.02	1.04	1.8	32.067	6	32	31.972071	2	4	6 \n \
                                     17	Cl	0.99	0.997	1.8	35.453	7	35	34.96885268	1 \n \
                                     18	Ar	1.57	1.74	1.88	39.948	8	40	39.96238312	0 \n \
                                     19	K	1.33	2.03	2.8	39.098	1	39	38.96370668	1 \n \
                                     20	Ca	0.99	1.74	2.4	40.078	2	40	39.96259098	2 \n \
                                     21	Sc	1.44	1.44	2.3	44.956	3	45	44.9559119	-1 \n \
                                     22	Ti	1.47	1.32	2.15	47.867	4	48	47.9479463	-1 \n \
                                     23	V	1.33	1.22	2.05	50.942	5	50	49.9471585	-1 \n \
                                     24	Cr	1.35	1.18	2.05	51.996	6	52	51.9405075	-1 \n \
                                     25	Mn	1.35	1.17	2.05	54.938	7	55	54.9380451	-1 \n \
                                     26	Fe	1.34	1.17	2.05	55.845	8	56	55.9349375	-1 \n \
                                     27	Co	1.33	1.16	2.0	58.933	9	59	58.933195	-1 \n \
                                     28	Ni	1.5	1.15	2.0	58.693	10	58	57.9353429	-1 \n \
                                     29	Cu	1.52	1.17	2.0	63.546	11	63	62.9295975	-1 \n \
                                     30	Zn	1.45	1.25	2.1	65.39	2	64	63.9291422	-1 \n \
                                     31	Ga	1.22	1.26	2.1	69.723	3	69	68.9255736	3	   \n \
                                     32	Ge	1.17	1.188	2.1	72.61	4	74	73.9211778	4	   \n \
                                     33	As	1.21	1.2	2.05	74.922	5	75	74.9215965	3	5	7 \n \
                                     34	Se	1.22	1.17	1.9	78.96	6	80	79.9165213	2	4	6 \n \
                                     35	Br	1.21	1.167	1.9	79.904	7	79	78.9183371	1 \n \
                                     36	Kr	1.91	1.91	2.02	83.8	8	84	83.911507	0 \n \
                                     37	Rb	1.47	2.16	2.9	85.468	1	85	84.91178974	1 \n \
                                     38	Sr	1.12	1.91	2.55	87.62	2	88	87.9056121	2 \n \
                                     39	Y	1.78	1.62	2.4	88.906	3	89	88.9058483	-1 \n \
                                     40	Zr	1.56	1.45	2.3	91.224	4	90	89.9047044	-1 \n \
                                     41	Nb	1.48	1.34	2.15	92.906	5	93	92.9063781	-1 \n \
                                     42	Mo	1.47	1.3	2.1	95.94	6	98	97.9054082	-1 \n \
                                     43	Tc	1.35	1.27	2.05	98	7	97	96.906365	-1 \n \
                                     44	Ru	1.4	1.25	2.05	101.07	8	102	101.9043493	-1 \n \
                                     45	Rh	1.45	1.25	2.0	102.906	9	103	102.905504	-1 \n \
                                     46	Pd	1.5	1.28	2.05	106.42	10	106	105.903486	-1 \n \
                                     47	Ag	1.59	1.34	2.1	107.868	11	107	106.905097	-1 \n \
                                     48	Cd	1.69	1.48	2.2	112.412	2	114	113.9033585	-1 \n \
                                     49	In	1.63	1.44	2.2	114.818	3	115	114.903878	3 \n \
                                     50	Sn	1.46	1.385	2.25	118.711	4	120	119.9021947	2	4 \n \
                                     51	Sb	1.46	1.4	2.2	121.76	5	121	120.9038157	3	5	7 \n \
                                     52	Te	1.47	1.378	2.1	127.6	6	130	129.9062244	2 4 6 \n \
                                     53	I	1.4	1.387	2.1	126.904	7	127	126.904473	1	2	5 \n \
                                     54	Xe	1.98	1.98	2.16	131.29	8	132	131.9041535	0 	2 \n \
                                     55	Cs	1.67	2.35	3.0	132.905	1	133	132.9054519	1 \n \
                                     56	Ba	1.34	1.98	2.7	137.328	2	138	137.9052472	2 \n \
                                     57	La	1.87	1.69	2.5	138.906	3	139	138.9063533	-1 \n \
                                     58	Ce	1.83	1.83	2.48	140.116	4	140	139.9054387	-1 \n \
                                     59	Pr	1.82	1.82	2.47	140.908	3	141	140.9076528	-1 \n \
                                     60	Nd	1.81	1.81	2.45	144.24	4	142	141.9077233	-1 \n \
                                     61	Pm	1.8	1.8	2.43	145	5	145	144.912749	-1 \n \
                                     62	Sm	1.8	1.8	2.42	150.36	6	152	151.9197324	-1 \n \
                                     63	Eu	1.99	1.99	2.4	151.964	7	153	152.9212303	-1 \n \
                                     64	Gd	1.79	1.79	2.38	157.25	8	158	157.9241039	-1 \n \
                                     65	Tb	1.76	1.76	2.37	158.925	9	159	158.9253468	-1 \n \
                                     66	Dy	1.75	1.75	2.35	162.5	10	164	163.9291748	-1 \n \
                                     67	Ho	1.74	1.74	2.33	164.93	11	165	164.9303221	-1 \n \
                                     68	Er	1.73	1.73	2.32	167.26	12	166	165.9302931	-1 \n \
                                     69	Tm	1.72	1.72	2.3	168.934	13	169	168.9342133	-1 \n \
                                     70	Yb	1.94	1.94	2.28	173.04	14	174	173.9388621	-1 \n \
                                     71	Lu	1.72	1.72	2.27	174.967	15	175	174.9407718	-1 \n \
                                     72	Hf	1.57	1.44	2.25	178.49	4	180	179.94655	-1 \n \
                                     73	Ta	1.43	1.34	2.2	180.948	5	181	180.9479958	-1 \n \
                                     74	W	1.37	1.3	2.1	183.84	6	184	183.9509312	-1 \n \
                                     75	Re	1.35	1.28	2.05	186.207	7	187	186.9557531	-1 \n \
                                     76	Os	1.37	1.26	2.0	190.23	8	192	191.9614807	-1 \n \
                                     77	Ir	1.32	1.27	2.0	192.217	9	193	192.9629264	-1 \n \
                                     78	Pt	1.5	1.3	2.05	195.078	10	195	194.9647911	-1 \n \
                                     79	Au	1.5	1.34	2.1	196.967	11	197	196.9665687	-1 \n \
                                     80	Hg	1.7	1.49	2.05	200.59	2	202	201.970643	-1 \n \
                                     81	Tl	1.55	1.48	2.2	204.383	3	205	204.9744275	3 \n \
                                     82	Pb	1.54	1.48	2.3	207.2	4	208	207.9766521	2	4 \n \
                                     83	Bi	1.54	1.45	2.3	208.98	5	209	208.9803987	3	5	7 \n \
                                     84	Po	1.68	1.46	2.0	209	6	209	208.9824304	2 \n \
                                     85	At	1.7	1.45	2.0	210	7	210	209.987148	1 \n \
                                     86	Rn	2.4	2.4	2.0	222	8	211	210.990601	0 \n \
                                     87	Fr	2	2	2.0	223	1	223	223.0197359	1 \n \
                                     88	Ra	1.9	1.9	2.0	226	2	223	223.0185022	2 \n \
                                     89	Ac	1.88	1.88	2.0	227	3	227	227.0277521	-1 \n \
                                     90	Th	1.79	1.79	2.4	232.038	4	232	232.0380553	-1 \n \
                                     91	Pa	1.61	1.61	2.0	231.036	3	231	231.035884	-1 \n \
                                     92	U	1.58	1.58	2.3	238.029	4	238	238.0507882	-1 \n \
                                     93	Np	1.55	1.55	2.0	237	5	236	236.04657	-1 \n \
                                     94	Pu	1.53	1.53	2.0	244	6	238	238.0495599	-1 \n \
                                     95	Am	1.51	1.07	2.0	243	7	241	241.0568291	-1 \n \
                                     96	Cm	1.5	0	2.0	247	8	243	243.0613891	-1 \n \
                                     97	Bk	1.5	0	2.0	247	9	247	247.070307	-1 \n \
                                     98	Cf	1.5	0	2.0	251	10	249	249.0748535	-1 \n \
                                     99	Es	1.5	0	2.0	252	11	252	252.08298	-1 \n \
                                     100	Fm	1.5	0	2.0	257	12	257	257.095105	-1 \n \
                                     101	Md	1.5	0	2.0	258	13	258	258.098431	-1 \n \
                                     102	No	1.5	0	2.0	259	14	259	259.10103	-1 \n \
                                     103	Lr	1.5	0	2.0	262	15	262	262.10963	-1 \n \
                                     104	Rf	1.57	0	2.0	267	2	267	267.12153	-1 \n \
                                     105	Db	1.49	0	2.0	268	2 	268	268.12545	-1 \n \
                                     106	Sg	1.43	0	2.0	269	2	271	271.13347	-1 \n \
                                     107	Bh	1.41	0	2.0	270	2	270	270.13362	-1 \n \
                                     108	Hs	1.34	0	2.0	269	2	269	269.13406	-1 \n \
                                     109	Mt	1.29	0	2.0	278	2	278	278.15481	-1 \n \
                                     110	Ds	1.28	0	2.0	281	2	281	281.16206	-1 \n \
                                     111	Rg	1.21	0	2.0	281	2	281	281.16537	-1 \n \
                                     112	Cn	1.22	0	2.0	285	2	285	285.17411	-1 \n \
                                     113	Nh	1.36	0	2.0	284	2	284	284.17873	-1 \n \
                                     113	Uut	1.36	0	2.0	284	2	284	284.17873	-1 \n \
                                     114	Fl	1.43	0	2.0	289	2	289	289.19042	-1 \n \
                                     115	Mc	1.62	0	2.0	288	2	288	288.19274	-1 \n \
                                     115	Uup	1.62	0	2.0	288	2	288	288.19274	-1 \n \
                                     116	Lv	1.75	0	2.0	293	2	293	293.20449	-1 \n \
                                     117	Ts	1.65	0	2.0	292	2	292	292.20746	-1 \n \
                                     118	Og	1.57	0	2.0	294	2	294	294.21392	-1"
    _periodic_table_atom_data = None

    @classmethod
    def init(cls):
        cls._parse_periodic_table_atom_data()

    @classmethod
    def _parse_periodic_table_atom_data(cls):
        periodic_table_atom_data = {}
        for atom_data_str in re.split(r'\s+\n\s+', cls._periodic_table_atom_data_str):
            atom_data_split = re.split(r'\s+', atom_data_str)
            periodic_table_atom_data[atom_data_split[1]] = [int(atom_data_split[0]),
                                                            atom_data_split[1],
                                                            float(atom_data_split[2]),
                                                            float(atom_data_split[3]),
                                                            float(atom_data_split[4]),
                                                            float(atom_data_split[5]),
                                                            int(atom_data_split[6]),
                                                            int(atom_data_split[7]),
                                                            float(atom_data_split[8]),
                                                            cls._str_list_to_int_list(atom_data_split[9:])]
        cls._periodic_table_atom_data = periodic_table_atom_data

    @classmethod
    def _str_list_to_int_list(cls, str_list: List[str]) -> List[int]:
        return [int(r) for r in str_list]

    @classmethod
    def get_element_data(cls, symbol: str) -> namedtuple:
        if cls._periodic_table_atom_data is None:
            cls.init()
        try:
            data = cls._periodic_table_atom_data[symbol]
            res = AtomicD(atomic_num=data[0],
                          symbol=data[1],
                          covalent_radius=data[2],
                          rb0=data[3],
                          van_radius=data[4],
                          atomic_mass=data[5],
                          outshell_elec_num=data[6],
                          common_isotopic=data[7],
                          common_isotopic_mass=data[8],
                          valences=data[9])
            return res
        except KeyError:
            raise ValueError(f'can not find atom: {symbol}')

    @classmethod
    def get_valences(cls, symbol: str) -> List[int]:
        if cls._periodic_table_atom_data is None:
            cls.init()
        try:
            return cls._periodic_table_atom_data[symbol][-1]
        except KeyError:
            raise ValueError(f'can not find atom: {symbol}')


if __name__ == '__main__':
    AtomicData.init()
    a = AtomicData._periodic_table_atom_data
    print(1)
